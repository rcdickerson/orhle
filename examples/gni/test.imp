// A program that never leaks high-
// security state.
expected: valid;

forall: run[1];
exists: run[2];

pre:  (= run!1!low run!2!low);
post: (= run!1!low run!2!low);

aspecs:
  RandB(max) {
    pre:  true;
    post: (and (>= 0 ret!) (< ret! max));
  }

especs:
  RandB(max) {
    choiceVars: n;
    pre:  (and (>= 0 n) (< n max));
    post: (= ret! n);
  }

prog run(high, low):
  r := call RandB(high);
  low := high + r;
endp